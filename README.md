Code for Martin et al. submitted
