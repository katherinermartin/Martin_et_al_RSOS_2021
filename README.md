Code for Martin et al.
